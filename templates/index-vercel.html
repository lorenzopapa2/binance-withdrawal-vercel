<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binance 自动提币系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-coins"></i> Binance 自动提币系统
            </a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text" id="connection-status">
                    <i class="fas fa-circle text-danger"></i> 未连接
                </span>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- API配置和IP信息 -->
        <div class="row mb-4">
            <!-- API配置 -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-key"></i> API 配置</h5>
                    </div>
                    <div class="card-body">
                        <form id="api-config-form">
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">API Key</label>
                                    <input type="text" class="form-control" id="api-key" placeholder="输入Binance API Key">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">API Secret</label>
                                    <input type="password" class="form-control" id="api-secret" placeholder="输入Binance API Secret">
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <label class="form-label">测试网络</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="testnet" checked>
                                        <label class="form-check-label" for="testnet">启用测试网络</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">&nbsp;</label>
                                    <button type="submit" class="btn btn-primary d-block w-100">
                                        <i class="fas fa-save"></i> 保存配置
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- IP信息 -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-network-wired"></i> 本机IP信息</h5>
                        <button class="btn btn-sm btn-outline-primary" onclick="refreshIPInfo()">
                            <i class="fas fa-refresh"></i> 刷新
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="ip-info">
                            <p><strong>客户端IP:</strong> <span id="client-ip">正在获取...</span></p>
                            <p><strong>服务器区域:</strong> <span id="server-region">正在获取...</span></p>
                        </div>
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i>
                            配置API白名单时请使用这些IP地址
                        </small>
                    </div>
                </div>
            </div>
        </div>

        <!-- 提币操作和账户信息 -->
        <div class="row mb-4">
            <!-- 提币操作 (左侧，更大) -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-paper-plane"></i> 智能批量提币</h5>
                    </div>
                    <div class="card-body">
                        <form id="withdrawal-form">
                            <!-- 基础配置 -->
                            <div class="row mb-3">
                                <div class="col-md-4">
                                    <label class="form-label">币种</label>
                                    <select class="form-select" id="coin" required>
                                        <option value="">选择币种</option>
                                        <option value="USDT">USDT</option>
                                        <option value="BTC">BTC</option>
                                        <option value="ETH">ETH</option>
                                        <option value="BNB">BNB</option>
                                        <option value="BUSD">BUSD</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">网络</label>
                                    <select class="form-select" id="network" required>
                                        <option value="">选择网络</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">提币模式</label>
                                    <select class="form-select" id="withdrawal-mode">
                                        <option value="fixed">固定数量</option>
                                        <option value="random">随机数量</option>
                                    </select>
                                </div>
                            </div>

                            <!-- 数量配置 -->
                            <div class="row mb-3">
                                <div class="col-md-6" id="fixed-amount-config">
                                    <label class="form-label">固定数量</label>
                                    <input type="number" class="form-control" id="fixed-amount" placeholder="输入固定提币数量" step="0.00000001">
                                </div>
                                <div class="col-md-6" id="random-amount-config" style="display: none;">
                                    <label class="form-label">随机数量区间</label>
                                    <div class="input-group">
                                        <input type="number" class="form-control" id="min-amount" placeholder="最小值" step="0.00000001">
                                        <span class="input-group-text">-</span>
                                        <input type="number" class="form-control" id="max-amount" placeholder="最大值" step="0.00000001">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">时间间隔 (秒)</label>
                                    <div class="input-group">
                                        <input type="number" class="form-control" id="min-interval" placeholder="最小间隔" value="1" min="1">
                                        <span class="input-group-text">-</span>
                                        <input type="number" class="form-control" id="max-interval" placeholder="最大间隔" value="5" min="1">
                                    </div>
                                </div>
                            </div>

                            <!-- 大的地址输入框 -->
                            <div class="mb-3">
                                <label class="form-label">
                                    <i class="fas fa-list"></i> 提币地址列表
                                    <small class="text-muted">(一行一个地址)</small>
                                </label>
                                <textarea class="form-control" id="address-list" rows="12"
                                    placeholder="请输入提币地址，一行一个地址：&#10;&#10;0x1234567890abcdef1234567890abcdef12345678&#10;0xabcdef1234567890abcdef1234567890abcdef12&#10;0x9876543210fedcba9876543210fedcba98765432&#10;&#10;支持以下格式：&#10;- 仅地址：0x1234...&#10;- 地址+标签：0x1234...,memo123"></textarea>
                                <div class="d-flex justify-content-between align-items-center mt-2">
                                    <small class="text-muted">
                                        <i class="fas fa-info-circle"></i>
                                        支持格式：地址 或 地址,标签
                                    </small>
                                    <div>
                                        <button type="button" class="btn btn-sm btn-outline-info" onclick="validateAddressList()">
                                            <i class="fas fa-check"></i> 验证地址
                                        </button>
                                        <span id="address-validation-result" class="ms-2"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- 提交按钮 -->
                            <div class="d-grid">
                                <button type="submit" class="btn btn-warning btn-lg">
                                    <i class="fas fa-rocket"></i>
                                    开始智能批量提币
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- 账户信息 (右侧，较小) -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-wallet"></i> 账户信息</h5>
                        <button class="btn btn-sm btn-outline-primary" onclick="refreshAccount()">
                            <i class="fas fa-refresh"></i> 刷新
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="account-info">
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>资产</th>
                                            <th>可用</th>
                                            <th>冻结</th>
                                            <th>总计</th>
                                        </tr>
                                    </thead>
                                    <tbody id="balances-list">
                                        <tr>
                                            <td colspan="4" class="text-center text-muted">请先配置API连接</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>

        <!-- 提币历史和日志 -->
        <div class="row">
            <!-- 提币历史 -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-history"></i> 提币历史</h5>
                        <button class="btn btn-sm btn-outline-primary" onclick="refreshWithdrawalHistory()">
                            <i class="fas fa-refresh"></i> 刷新
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>时间</th>
                                        <th>币种</th>
                                        <th>网络</th>
                                        <th>数量</th>
                                        <th>状态</th>
                                        <th>交易ID</th>
                                    </tr>
                                </thead>
                                <tbody id="withdrawal-history">
                                    <tr>
                                        <td colspan="6" class="text-center text-muted">暂无记录</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 实时日志 -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-terminal"></i> 实时日志</h5>
                        <button class="btn btn-sm btn-outline-secondary" onclick="clearLogs()">
                            <i class="fas fa-trash"></i> 清空
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="real-time-logs" style="height: 300px; overflow-y: auto; font-family: monospace; font-size: 12px;">
                            <div class="text-muted">等待日志...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 确认提币模态框 -->
    <div class="modal fade" id="confirmModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">确认提币</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        请仔细核对提币信息，提币操作不可撤销！
                    </div>
                    <div id="withdrawal-details"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-danger" id="confirm-withdraw">确认提币</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app-vercel-simple.js') }}"></script>
</body>
</html>
